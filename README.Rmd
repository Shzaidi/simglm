Regression simulation function
===============================

A flexible suite of functions to simulate nested data.  
Currently supports the following featurs:
* Longitudinal data simulation
* Two levels of nesting
* Specification of distribution of random effects
* Specification of distribution of within cluster errors
* Specification of serial correlation
* Specification of population parameters
 *Including both fixed and random effects
* Specification of the number of variables
 * Ability to add time-varying covariates
 * Specify the mean and variance of fixed covariate variables
* Generation of mixture normal distributions
 * Ability to compute variance of each normal distribution in each mixture distribution
   based on equal weighting.
* Cross sectional data simulation
* Single level simulation

Features coming soon:
* Adding factor variable simulation
* More options for simulating random components
 * More distributions
 * Ability to simulate different distributions for different random effects
* Power by simulation
* Missing Data
* Ability to specify correlation amount random effects individually.
* Expand variance of mixture distribution function to include unequal weighting.

Single level simulation example
============================

Simulating a single level regression model with sim.reg.single, mean centered variables.  This function outputs the entire design matrix, the error, the cross product, simulated data, and the ID variable.

```{r single, message = FALSE}
library(simReg)
fixed <- ~ 1 + act + diff + numCourse + act:numCourse
fixed.param <- c(2, 4, 1, 3.5, 2)
cov.param <- list(c(0,4), c(0, 3), c(0, 3))
n <- 150
errorVar <- 3
err.dist <- "norm"
head(temp.single <- sim.reg.single(fixed, fixed.param, cov.param, n, errorVar, err.dist), n = 15)

##Fitting regression to obtain parameter estimates
summary(lm(sim.data ~ 1 + act + diff + numCourse + act:numCourse, data = temp.single))
```

Multilevel simulation example
==========================

Longitudinal Data
-------------------
Simulating a multilevel regression model with sim.reg.nested, more specifically longitudinal data with mean centered covariates.  This function outputs the entire design matrix, individual random effects, the error, the cross product, total random effect contribution, simulated data, within cluster ID variable, and cluster level ID variable.

```{r long, message = FALSE}
library(simReg)
fixed <- ~ 1 + time + diff + act + time:act + diff:act
random <- ~ 1 + time
fixed.param <- c(4, 2, 6, 2.3, 7, 3)
random.param <- c(7, 4)
w.var <- 3
cov.param <- list(c(0, 1.5), c(0, 4))
n <- 50
p <- 6
errorVar <- 4
randCor <- 0
rand.dist <- "norm"
err.dist <- "norm"
serCor <- "ID"
serCorVal <- NULL
data.str <- "long"
head(temp.long <- sim.reg.nested(fixed, random, fixed.param, random.param, w.var, cov.param, n, p, errorVar,
               randCor, rand.dist, err.dist, serCor, serCorVal, data.str), n = 15)

##fitting lmer model
library(lme4)
lmer(sim.data ~ 1 + time + diff + act + time:act + diff:act + (1 + time|clustID), data = temp.long)
```

Cross Sectional Data
----------------------
```{r cross, message = FALSE}
library(simReg)
fixed <- ~ 1 + numCourse + act + numCourse:act
random <- ~ 1
fixed.param <- c(10, 3, 6, 5)
random.param <- c(6)
w.var <- 3
cov.param <- list(c(0, 1.5), c(0, 4))
n <- 60
p <- 18
errorVar <- 4
randCor <- 0
rand.dist <- "norm"
err.dist <- "norm"
serCor <- "ID"
serCorVal <- NULL
data.str <- "cross"
head(temp.cross <- sim.reg.nested(fixed, random, fixed.param, random.param, w.var, cov.param, n, p, errorVar,
               randCor, rand.dist, err.dist, serCor, serCorVal, data.str), n = 15)

##fitting lmer model
library(lme4)
lmer(sim.data ~ 1 + numCourse + act + numCourse:act + (1 | clustID), data = temp.cross)
```

Using sim.reg
================

Single Level
--------------

```{r singlesimReg, message = FALSE}
library(simReg)
fixed <- ~ 1 + act + diff + numCourse + act:numCourse
fixed.param <- c(2, 4, 1, 3.5, 2)
cov.param <- list(c(0,4), c(0, 3), c(0, 3))
n <- 150
errorVar <- 3
err.dist <- "norm"
head(temp.single <- sim.reg(fixed = fixed, fixed.param = fixed.param, cov.param = cov.param, n = n, 
                            errorVar = errorVar, err.dist = err.dist, data.str = "single"), n = 15)

##Fitting regression to obtain parameter estimates
summary(lm(sim.data ~ 1 + act + diff + numCourse + act:numCourse, data = temp.single))
```

```{r simreg, message = FALSE}
library(simReg)
fixed <- ~ 1 + time + diff + act + time:act 
random <- ~ 1 + time + diff
fixed.param <- c(4, 2, 6, 2.3, 7)
random.param <- c(7, 4, 2)
w.var <- 3
cov.param <- list(c(0, 1.5), c(0, 4))
n <- 150
p <- 30
errorVar <- 4
randCor <- 0
rand.dist <- "norm"
err.dist <- "norm"
serCor <- "ID"
serCorVal <- NULL
data.str <- "long"
head(temp.long <- sim.reg(fixed, random, fixed.param, random.param, w.var, cov.param, n, p, errorVar,
               randCor, rand.dist, err.dist, serCor, serCorVal, data.str), n = 15)

##fitting lmer model
library(lme4)
lmer(sim.data ~ 1 + time + diff + act + time:act + (1 + time + diff|clustID), data = temp.long)
```
